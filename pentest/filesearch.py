#!/usr/bin/env python
# -*- coding: utf-8 -*-
#title           :filesearch.py
#description     :This program search a string on a file, providing both values on the arguments
#author          :
#date            :
#version         :0.1
#usage           : filesearch.py [ --string ] <string>  [ --file ] <filepath>
#notes           :
#python_version  :2.7.6  
#=======================================================================
 
import os,sys
import argparse #Standard python library for parsing command-line arguments

def filesearch():    ##Defines module filesearch()
    os.system('clear')

    is_error = False
    for index, arg in enumerate(sys.argv):  #Defines de usage of the --file argument and save the argument index+1
        if arg in ['--file', '-f']:
            fls = sys.argv[index+1]
            del sys.argv[index]
            break
    for index, arg in enumerate(sys.argv):  #Defines de usage of the --string argument and save the argument index+1
        if arg in ['--string', '-s']:
            textla = sys.argv[index+1]
            del sys.argv[index]
            break

    if len(sys.argv) == 1 :  #if the argument is empty it will change the variable is_error to True to show usage
        is_error = True
    else:
        for arg in sys.argv:
            if arg.startswith('-'):
                is_error = True

    if is_error:
        print ('\nUsage: ' + sys.argv[0]+ '[ --string ] <string>  [ --file ] <filepath>\n')
    else:
        raw_input("Press enter to continue ...")    ##Generate a pause
        fdesc = open(fls)   ## Open file enter as argument 1 for read

        with fdesc as fp :
            lines = fdesc.readlines()
            c=0
            for l in lines:
                if textla in l:
                    print(l)

if __name__ == '__main__':  #Define main function
    filesearch()
